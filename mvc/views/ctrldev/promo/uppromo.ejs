<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastrar Promoções</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>

<body>
    <main>
        <h2> Atualizar Promoção</h2>
        <section id="alterpromos">
            <form id="form-promocao">
                <!-- Iniciando primeira -->
                <div class="row">
                    <input value="<%= promocao.id %>" aria-hidden="true" type="hidden" id="txtid" name="txtid">
                    <div class="col">
                        <label for="txtnomepromo" class="form-label">Nome da Promoçao</label>
                        <input value="<%= promocao.nome_promo %>" type="text" class="form-control" name="txtnomepromo"
                            id="txtnomepromo" tabindex="1" autofocus>
                    </div>
                    <div class="col">
                        <label for="seldescpromo" class="form-label">Desconto</label>
                        <select name="seldescpromo" id="seldescpromo" class="form-control" tabindex="2">
                            <option value="">Selecione um Desconto</option>
                        </select>
                    </div>
                </div>
                <!-- Iniciando segunda linha -->
                <div class="row mt-4">
                    <div class="col">
                        <label for="dtstartpromo" class="form-label">Inicio da Promoção</label>
                        <input value="<%= promocao.dt_start %>" type="date" class="form-control" name="dtstartpromo"
                            id="dtstartpromo" tabindex="3">
                    </div>
                    <div class="col">
                        <label for="dtendpromo" class="form-label">Fim da Promoção</label>
                        <input value="<%= promocao.dt_end %>" type="date" class="form-control" name="dtendpromo"
                            id="dtendpromo" tabindex="4">
                    </div>
                    <div class="col m-4 ">
                        <p>Promomoção ativa?</p>
                        <label for="radioativapromosim" class="form-check-label m-2">Sim </label>
                        <input type="radio" name="radioativapromosim" id="radioativapromosim"
                            class="form-check-input m-2" tabindex="5" value="1">
                        <label for="radioativapromonao" class="form-check-label m-2">Não </label>
                        <input type="radio" name="radioativapromosim" id="radioativapromonao" class="form-check-input m-2 "
                            tabindex="6" value="0">
                    </div>
                </div>
                <label for="txtdescpromo">Descrição</label>
                <textarea name="txtdescpromo" id="txtdescpromo" cols="" rows="10" value="<%= promocao.descr_promo %>"
                    class="form-control" tabindex="7"></textarea>

                <div class="row">
                        <a href="/promocao/lista"><button class="btn btn-primary mt-4" value="Cadastrar" name="btcadpromo"
                            id="btcadpromo" tabindex="5">Atualizar Promoção</button></a>
                </div>
            </form>
        </section>
    </main>

    <script>

        document.getElementById("form-promocao").addEventListener("submit", (e) => {
            e.preventDefault()
            atualizar()
        })

        async function atualizar() {

            const promocao = {
                "id": document.getElementById("txtid").value,
                "nome_promo": document.getElementById("txtnomepromo").value,
                "dt_start": document.getElementById("dtstartpromo").value,
                "dt_end": document.getElementById("dtendpromo").value,
                "descr_promo": document.getElementById("txtdescpromo").value,
                "ativa": document.getElementById("radioativapromonao").value
            }


            const resposta = await fetch(`/promocao/alterar`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(promocao)
            })
            const json = await resposta.json()
            const status = await json

            console.log(promocao)

      

        }

    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
</body>

</html>